# 4.2.1 TCP特点和报文段格式

## 1. TCP协议的特点

1. 面向连接
2. 点对点
3. 可靠交付
4. 全双工
5. 面向字节流

## 2. TCP的报文段首部格式

<center><img src="https://youpai.roccoshi.top/img/20200718220249.png"><br><div style="border-bottom: 1px solid #d9d9d9;display: inline-block;color: #999;    padding: 2px;">TCP报文段首部</div> </center>

**解释** : 

- **序号** : 在一个TCP连接中传送的字节流中的每一个字节都按顺序编号, 本字段表示本报文段所发送数据的第一个字节的序号
- **确认号** : **期望**收到对望下一个报文段的第一个数据字节的序号, 若确认号为N, 则证明到序号N-1为止的所有数据都已经正确收到
- **数据偏移** ( 首部长度 ) : TCP报文段的数据起始处距离TCP报文段的起始处有多远, 以**4B位为单位**, 即一个数值是4B

- **六个控制位** : 

  - **紧急位URG** : URG = 1时, 标明此报文段中有紧急数据, 是高优先级的数据, 应尽快传送, 不用在缓存里排队, 配合紧急指针字段使用

  - **确认位ACK** : ACK = 1时确认号有效, 在连接建立后所有传送的报文段都必须把ACK置为1
  - **推送位PSH** : PSH = 1时, 接收方尽快交付接受应用进程, 不用等到缓存填满再向上交付
  - **复位RST** : RST = 1时, 表明TCP连接中出现严重差错, 必须释放连接, 然后再重新建立传输连接
  - **同步位SYN** : SYN = 1时, 表明是一个连接请求 / 连接接受报文
  - **终止位FIN** : FIN = 1时, 表明此报文段发送方数据已发完, 要求释放连接

- **窗口** : 指的是发送本报文段的一方的接收窗口, 即现在允许对方发送的数据量
- **校验和** : 检验首部 + 数据, 检验时要加上12B伪首部, 第四个字段为6
- **紧急指针** : URG = 1时才有意义, 指出本报文段中紧急数据的字节数
- **选项** : ...

- **填充** : 使得首部为4B的整数倍





